# Guidelines Gerais do Projeto Notikfy

Este documento contém padrões e convenções compartilhadas entre backend e frontend do projeto Notikfy.

## Estrutura do Repositório

```
notikfy/
├── backend/          # Cloud Functions (Firebase)
├── frontend/         # React SPA
└── docs/            # Documentação adicional (opcional)
```

## Versionamento (Git)

### Estratégia de Branches
- **Branch principal**: `main` (produção)
- **Branches de feature**: `feature/nome-da-feature`
- **Branches de bugfix**: `bugfix/descricao-do-bug`
- **Branches de hotfix**: `hotfix/descricao-urgente`

### Convenção de Commits
Seguir o padrão [Conventional Commits](https://www.conventionalcommits.org/):

```
<type>(<scope>): <subject>

<body> (opcional)

<footer> (opcional)
```

**Tipos:**
- `feat`: Nova funcionalidade
- `fix`: Correção de bug
- `docs`: Documentação
- `style`: Formatação (não afeta código)
- `refactor`: Refatoração
- `test`: Testes
- `chore`: Tarefas de manutenção

**Exemplos:**
```
feat(backend): adiciona validação de assinatura de webhook TikTok
fix(frontend): corrige exibição de vendas no dashboard
docs: atualiza README com instruções de setup
```

## Padrões Compartilhados

### TypeScript
- **Versão mínima**: 5.0+
- Usar tipagem estrita (`strict: true`)
- Preferir `interface` para objetos, `type` para unions/intersections
- Evitar `any` - usar `unknown` quando necessário

### Variáveis de Ambiente
- Usar arquivos `.env` para configurações locais
- Criar `.env.example` como template (sem valores sensíveis)
- **NUNCA** commitar arquivos `.env` com credenciais
- Documentar todas as variáveis necessárias

**Estrutura sugerida:**
```
.env.example          # Template com nomes das variáveis
.env.local            # Valores locais (gitignored)
.env.production       # Valores de produção (se necessário)
```

### ESLint e Prettier
- Configuração padronizada entre projetos
- Executar lint antes de commits (via husky ou similar)
- Formatação automática no save (configurar no editor)

### Testes
- **Backend**: Jest para unit tests das Cloud Functions
- **Frontend**: Jest + React Testing Library para componentes
- Cobertura mínima recomendada: 70% para código crítico
- Testes devem ser independentes e isolados

### Logging e Monitoramento
- Usar logs estruturados (JSON format)
- Níveis: `error`, `warn`, `info`, `debug`
- Backend: Firebase Functions Logs
- Frontend: Console logs em desenvolvimento, serviços de logging em produção

### Segurança
- **NUNCA** expor credenciais no código
- Validar e sanitizar todos os inputs
- Usar Firebase Security Rules no Firestore
- Implementar rate limiting em endpoints públicos
- Headers de segurança apropriados (CORS, CSP, etc.)

## Convenções de Código

### Nomenclatura
- **Variáveis e funções**: `camelCase`
- **Componentes React**: `PascalCase`
- **Constantes**: `UPPER_SNAKE_CASE`
- **Arquivos**: `kebab-case` para utilitários, `PascalCase` para componentes

### Organização de Imports
Ordem sugerida:
1. Bibliotecas externas (React, Firebase, etc.)
2. Bibliotecas internas/compartilhadas
3. Componentes
4. Utilitários e helpers
5. Tipos e interfaces
6. Arquivos relativos (com `./` ou `../`)

**Exemplo:**
```typescript
// 1. Bibliotecas externas
import React, { useState, useEffect } from 'react';
import { getAuth } from 'firebase/auth';

// 2. Componentes
import { Button } from '@mui/material';

// 3. Utilitários
import { formatDate } from '../utils/date';

// 4. Tipos
import { User } from '../types/user';

// 5. Relativos
import { CustomComponent } from './CustomComponent';
```

### Comentários
- Comentar código complexo ou não óbvio
- Usar JSDoc para funções públicas
- Manter comentários atualizados com o código
- Preferir código auto-explicativo a comentários

**Exemplo JSDoc:**
```typescript
/**
 * Valida e processa um webhook do TikTok
 * @param payload - Payload JSON do webhook
 * @param signature - Assinatura HMAC para validação
 * @returns Objeto com resultado do processamento
 */
async function processWebhook(payload: any, signature: string) {
  // ...
}
```

## Workflow de Desenvolvimento

1. **Criar branch** a partir de `main`
2. **Desenvolver** seguindo os padrões
3. **Escrever testes** para novas funcionalidades
4. **Validar** com lint e testes
5. **Criar Pull Request** para revisão
6. **Merge** após aprovação

## Ferramentas Recomendadas

- **Editor**: VS Code com extensões ESLint, Prettier, TypeScript
- **Git**: Interface gráfica opcional (SourceTree, GitKraken, etc.)
- **API Testing**: Postman ou Insomnia para testar webhooks
- **Firebase Console**: Para monitoramento e configuração

## Documentação

- Manter README.md atualizado em cada módulo
- Documentar APIs e endpoints
- Incluir exemplos de uso
- Manter changelog para versões principais

## Contato e Suporte

Para dúvidas sobre padrões ou convenções, consultar este documento primeiro ou discutir com o time.

